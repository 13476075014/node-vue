webpackJsonp([7],{ia7Y:function(t,s,a){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i=a("Dd8w"),e=a.n(i),o=a("NYxO"),n=a("SC/i"),l=a("NNPm"),r={data:function(){return{show:!1,items:[],showLoad:!1,loadTitle:"正在注销",dialogVisible:!1,appendToBody:!0,imageUrl:""}},activated:function(){this.$emit("changtab","3")},created:function(){var t=this;this.init(),setTimeout(function(){t.show=!0},20)},methods:e()({init:function(){var t=this;this.$axios.get("api/AppUser/GetUserInfo?CanteenToken="+this.userToken).then(function(s){console.log(s),1===s.data.Code&&(t.setUserInfo(s.data.Data),t.items=s.data.Data)}).catch(function(s){s.response.data.Message.match("Token")||t.$alert("请求出错！！",{customClass:"myConfirm"})})},signout:function(){var t=this;this.showLoad=!0,this.userToken?this.$axios({method:"post",url:"api/AppLogin/Logout?token="+this.userToken}).then(function(s){1===s.data.Code?setTimeout(function(){t.showLoad=!1,t.setUserToken(Object(l.a)()),t.$router.push("/login")},1e3):setTimeout(function(){t.showLoad=!1,console.log(s.data.Message),t.$router.push("/login")},1e3)}).catch(function(s){t.showLoad=!1,t.$alert("请求错误",{customClass:"myConfirm"}),t.$router.push("/login")}):this.$router.push("/login")},updateImg:function(){this.dialogVisible=!0},handleChange:function(t,s){this.files=t.raw,this.imageUrl=URL.createObjectURL(t.raw)},submitImgForm:function(){var t=this,s=new FormData;s.append("file",this.files),this.$axios.post("api/AppUser/UpdateUserHeadImg?CanteenToken="+this.userToken+"&isformdata=0",s,{headers:{"Content-Type":"multipart/form-data"}}).then(function(s){console.log(s),1===s.data.Code&&(t.dialogVisible=!1,t.$message({message:"上传成功",type:"success"}),t.init())}).catch(function(s){s.response.data.Message.match("Token")?(t.$message({message:"登录过期，请重新登录，即将跳转到登录页面！！",duration:2200}),setTimeout(function(){t.$router.push("/login")},2e3)):t.$alert("请求出错！！",{customClass:"myConfirm"})})},showMyMessage:function(){this.$alert("您还没有消息！！",{customClass:"myConfirm"})}},Object(o.b)({setUserToken:"SET_USER_TOKEN",setUserInfo:"SET_USER_INFO"})),computed:e()({},Object(o.c)(["userToken"])),components:{Loading:n.a}},c={render:function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("transition",{attrs:{name:"leftIn"}},[t.show?i("div",{staticClass:"user"},[t.showLoad?i("div",{ref:"loading",staticClass:"loading_out"},[i("loading",{staticClass:"loading",attrs:{title:t.loadTitle}})],1):t._e(),t._v(" "),i("div",{staticClass:"top"},[i("div",{staticClass:"topbg"}),t._v(" "),i("div",{staticClass:"card"},[i("div",{staticClass:"inner"},[i("div",[i("img",{attrs:{src:t.items.HeadImg?"http://chenxiaoming.canteen.sundar.top:8060/"+t.items.HeadImg:a("FWfe"),alt:""},on:{click:t.updateImg}}),t._v(" "),i("p",[t._v(t._s(t.items.Account))])])])])]),t._v(" "),i("div",{staticClass:"content"},[i("ul",[i("li",{on:{click:t.showMyMessage}},[i("div",{staticClass:"left"},[i("div",{staticClass:"fl"},[t._v("\n              我的消息\n            ")])]),t._v(" "),i("div",{staticClass:"right"},[i("i",{staticClass:"el-icon-arrow-right"})])]),t._v(" "),i("li",[i("div",{staticClass:"left"},[i("div",{staticClass:"fl"},[t._v("\n              我的建议\n            ")])]),t._v(" "),i("div",{staticClass:"right"},[i("i",{staticClass:"el-icon-arrow-right"})])]),t._v(" "),i("router-link",{attrs:{to:"/index/myrate"}},[i("li",[i("div",{staticClass:"left"},[i("div",{staticClass:"fl"},[t._v("\n              我的点评\n            ")])]),t._v(" "),i("div",{staticClass:"right"},[i("i",{staticClass:"el-icon-arrow-right"})])])]),t._v(" "),i("li",[i("div",{staticClass:"left"},[i("div",{staticClass:"fl"},[t._v("\n              联系方式\n            ")])]),t._v(" "),i("div",{staticClass:"right"},[i("span",[t._v(t._s(t.items.Mobile))])])])],1),t._v(" "),i("div",{staticClass:"sub"},[i("el-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:function(s){t.signout()}}},[t._v("注销")])],1)]),t._v(" "),i("el-dialog",{staticStyle:{"text-align":"center"},attrs:{title:"上传头像","append-to-body":t.appendToBody,visible:t.dialogVisible},on:{"update:visible":function(s){t.dialogVisible=s}}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","auto-upload":!1,"show-file-list":!1,"on-change":t.handleChange}},[t.imageUrl?i("img",{staticClass:"avatar",attrs:{src:t.imageUrl}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),t._v(" "),i("span",{staticClass:"dialog-footer text-center",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(s){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(s){t.submitImgForm()}}},[t._v("确 定")])],1)],1)],1):t._e()])},staticRenderFns:[]};var d=a("VU/8")(r,c,!1,function(t){a("rJ8f")},"data-v-11b4b00a",null);s.default=d.exports},rJ8f:function(t,s){}});
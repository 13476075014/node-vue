webpackJsonp([6],{K31e:function(s,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=t("Dd8w"),r=t.n(o),a=t("SC/i"),i=t("NYxO"),l={data:function(){var s=this,e=function(s,e,t){if(!e)return t(new Error("不能为空"));t()};return{show:!1,canUse:!1,showLoad:!1,showClose:!1,dialogVisible:!1,ruleForm2:{pass:"",user:""},signUpForm:{Sex:"0",Account:"",Password:"",Name:"",Mobile:""},rules2:{pass:[{validator:function(e,t,o){s.ruleForm2.user?""===t?o(new Error("请输入密码")):(s.canUse=!0,o()):(s.ruleForm2.pass="",o(new Error("请先输入用户名")))},trigger:"change"}],user:[{validator:e,trigger:"blur"}]},signUpFormRules:{Account:[{validator:e,trigger:"blur"}],Password:[{validator:e,trigger:"blur"}]}}},created:function(){var s=this;this.ruleForm2.user&&this.ruleForm2.pass&&(this.canUse=!0),setTimeout(function(){s.show=!0},20)},methods:r()({submitForm:function(s){var e=this;this.$refs[s].validate(function(t){if(!t)return console.log("error submit!!"),!1;e.showLoad=!0,e.$axios({method:"post",url:"api/AppLogin/Login",data:{Account:e.ruleForm2.user,Password:e.ruleForm2.pass}}).then(function(t){1===t.data.Code?(e.setUserToken(t.data.Data),setTimeout(function(){e.showLoad=!1,e.$router.push("/index")},1e3)):(e.resetForm(s),e.showLoad=!1,e.$alert(t.data.Message,{customClass:"myConfirm"}))}).catch(function(t){e.resetForm(s),e.showLoad=!1,e.$alert("请求出错！！",{customClass:"myConfirm"})})})},resetForm:function(s){this.canUse=!1,this.$refs[s].resetFields()},signUp:function(){this.dialogVisible=!0},submitsignUpForm:function(s){var e=this;this.$axios.post("api/AppUser/Add?CanteenToken="+this.userToken,r()({},this.signUpForm)).then(function(s){console.log(s),1===s.data.Code?(e.dialogVisible=!1,e.$message({message:"注册成功，可以用此账号登录啦！！",type:"success"})):e.$alert(s.data.data.Message,{customClass:"myConfirm"})}).catch(function(s){})}},Object(i.b)({setUserToken:"SET_USER_TOKEN"})),computed:r()({},Object(i.c)(["userToken"])),components:{Loading:a.a},watch:{"ruleForm2.pass":function(s){s.pass&&s.user&&(this.canUse=!0)}}},n={render:function(){var s=this,e=s.$createElement,o=s._self._c||e;return o("transition",{attrs:{name:"slide"}},[s.show?o("div",{staticClass:"login"},[s.showLoad?o("div",{ref:"loading",staticClass:"loading_out"},[o("loading",{staticClass:"loading"})],1):s._e(),s._v(" "),o("div",{staticClass:"bg"}),s._v(" "),o("div",{staticClass:"content"},[o("div",{staticClass:"top"},[o("div",{staticClass:"img"},[o("img",{attrs:{src:t("SyTM"),alt:""}})]),s._v(" "),o("p",[s._v("智慧食堂")])]),s._v(" "),o("el-form",{ref:"ruleForm2",staticClass:"demo-ruleForm loginform",attrs:{model:s.ruleForm2,"status-icon":"",rules:s.rules2,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"",prop:"user"}},[o("i",{staticClass:"iconfont"},[s._v("")]),s._v(" "),o("el-input",{staticClass:"user defaultInput",attrs:{placeholder:"用户名"},model:{value:s.ruleForm2.user,callback:function(e){s.$set(s.ruleForm2,"user",e)},expression:"ruleForm2.user"}})],1),s._v(" "),o("el-form-item",{staticClass:"passOut",attrs:{prop:"pass"}},[o("i",{staticClass:"iconfont"},[s._v("")]),s._v(" "),o("el-input",{staticClass:"pass defaultInput",attrs:{placeholder:"密码",type:"password"},model:{value:s.ruleForm2.pass,callback:function(e){s.$set(s.ruleForm2,"pass",e)},expression:"ruleForm2.pass"}})],1),s._v(" "),o("el-form-item",[o("el-button",{class:{btn:!0,canUse:s.canUse},attrs:{type:"primary"},on:{click:function(e){s.submitForm("ruleForm2")}}},[s._v("登录")]),s._v(" "),o("el-button",{staticClass:"btn btn_reset",on:{click:s.signUp}},[s._v("注册")])],1)],1)],1),s._v(" "),o("el-dialog",{staticStyle:{"text-align":"center"},attrs:{title:"注册","show-close":s.showClose,visible:s.dialogVisible},on:{"update:visible":function(e){s.dialogVisible=e}}},[o("el-form",{ref:"signUpForm",staticClass:"demo-ruleForm signupForm",attrs:{"status-icon":"",rules:s.signUpFormRules,model:s.signUpForm,"label-width":"70px"}},[o("el-form-item",{attrs:{prop:"Sex",label:"性别："}},[o("el-select",{attrs:{placeholder:"请选择性别"},model:{value:s.signUpForm.Sex,callback:function(e){s.$set(s.signUpForm,"Sex",e)},expression:"signUpForm.Sex"}},[o("el-option",{attrs:{label:"男",value:"0"}}),s._v(" "),o("el-option",{attrs:{label:"女",value:"1"}})],1)],1),s._v(" "),o("el-form-item",{attrs:{prop:"Account",label:"用户名："}},[o("el-input",{attrs:{type:"text",placeholder:"请填写用户名"},model:{value:s.signUpForm.Account,callback:function(e){s.$set(s.signUpForm,"Account",e)},expression:"signUpForm.Account"}})],1),s._v(" "),o("el-form-item",{attrs:{prop:"Password",label:"密码："}},[o("el-input",{attrs:{type:"password",placeholder:"请填写密码"},model:{value:s.signUpForm.Password,callback:function(e){s.$set(s.signUpForm,"Password",e)},expression:"signUpForm.Password"}})],1),s._v(" "),o("el-form-item",{attrs:{prop:"Name",label:"姓名："}},[o("el-input",{attrs:{type:"text",placeholder:"请填写姓名"},model:{value:s.signUpForm.Name,callback:function(e){s.$set(s.signUpForm,"Name",e)},expression:"signUpForm.Name"}})],1),s._v(" "),o("el-form-item",{attrs:{prop:"Mobile",label:"手机号："}},[o("el-input",{attrs:{type:"text",placeholder:"请填写手机号"},model:{value:s.signUpForm.Mobile,callback:function(e){s.$set(s.signUpForm,"Mobile",e)},expression:"signUpForm.Mobile"}})],1)],1),s._v(" "),o("span",{staticClass:"dialog-footer text-center",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"small"},on:{click:function(e){s.dialogVisible=!1}}},[s._v("取 消")]),s._v(" "),o("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){s.submitsignUpForm("signUpForm")}}},[s._v("确 定")])],1)],1)],1):s._e()])},staticRenderFns:[]};var c=t("VU/8")(l,n,!1,function(s){t("QmuN")},"data-v-1f8ba5c0",null);e.default=c.exports},QmuN:function(s,e){}});
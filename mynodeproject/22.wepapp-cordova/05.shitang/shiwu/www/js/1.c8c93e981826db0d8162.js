webpackJsonp([1],{"1oqp":function(t,e){},"6+aJ":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=o("Dd8w"),s=o.n(a),i={props:{title:{type:String,default:"111"},showArrow:{type:Boolean,default:!0}},methods:{goBack:function(){this.$emit("back"),this.$router.back()}}},r={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"head"},[o("el-row",[o("el-col",{staticClass:"left",staticStyle:{"min-height":"1px"},attrs:{span:5}},[o("i",{directives:[{name:"show",rawName:"v-show",value:t.showArrow,expression:"showArrow"}],staticClass:"el-icon-arrow-left",on:{click:t.goBack}})]),t._v(" "),o("el-col",{attrs:{span:14}},[t._v("\n      "+t._s(t.title)+"\n    ")]),t._v(" "),o("el-col",{attrs:{span:5}},[t._t("default")],2)],1)],1)},staticRenderFns:[]};var n=o("VU/8")(i,r,!1,function(t){o("1oqp")},"data-v-30c48bbe",null).exports,l={data:function(){return{result:[{src:o("svS+")},{src:o("yiN2")},{src:o("FWfe")}]}},mounted:function(){var t=this;window.addEventListener("resize",function(){t.resizeHeight()})},methods:{resizeHeight:function(){var t=this.$refs.img[0].height;this.$refs.carouselOut.$el.style.height=t+20+"px"},hh:function(){this.resizeHeight()}},computed:{},watch:{}},c={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-carousel",{ref:"carouselOut",staticClass:"carouselOut",attrs:{interval:4e3}},t._l(t.result,function(e,a){return o("el-carousel-item",{key:a},[0==a?o("img",{ref:"img",refInFor:!0,attrs:{src:e.src,alt:"刷新看看"},on:{load:t.hh}}):t._e(),t._v(" "),0!=a?o("img",{ref:"img",refInFor:!0,attrs:{src:e.src,alt:"刷新看看"}}):t._e()])}),1)},staticRenderFns:[]};var u=o("VU/8")(l,c,!1,function(t){o("YRtv")},"data-v-3c0ccb05",null).exports,d={props:{index_active:{type:Number,default:0}},data:function(){return{result:[{text:"首页",icon:"&#xe691;",path:"/"},{text:"点评",icon:"&#xe621;",path:"/allrate"},{text:"建议",icon:"&#xe62c;",path:"/suggest"},{text:"我的",icon:"&#xe63d;",path:"/user"}]}},methods:{changeTab:function(t,e,o){this.$emit("changeTab",t,e,o)}}},m={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"bottom"}},[o("div",{staticClass:"inner"},t._l(t.result,function(e,a){return o("div",{key:a,class:{active:a===t.index_active},on:{click:function(o){t.changeTab(a,e.path,e.text)}}},[o("i",{staticClass:"iconfont",domProps:{innerHTML:t._s(e.icon)}}),t._v(" "),o("p",[t._v(t._s(e.text))])])}),0)])},staticRenderFns:[]};var h=o("VU/8")(d,m,!1,function(t){o("J2tC")},"data-v-b1b7b1e4",null).exports,f=o("G3Cf"),p=o("NYxO"),v=o("NNPm"),g=o("SC/i"),b={data:function(){var t=function(t,e,o){if(!e)return o(new Error("不能为空"));o()};return{activebottom:0,activeIndex2:"1",collapse_transition:!0,headTitle:"智慧食堂",hasradius:!0,showArrow:!1,dialogVisible:!1,showLoad:!0,show:!1,pullUpLoad:!1,showClose:!1,rateForm:{Content:"",star:0,productID:""},loadTitle:"正在加载",items:[],rateRules:{Content:[{validator:t,trigger:"blur"}],star:[{validator:t,trigger:"blur"}],productID:[{validator:t,trigger:"blur"}]}}},created:function(){var t=this;this.initItem(),setTimeout(function(){t.show=!0},20)},methods:s()({initItem:function(){var t=this;this.$axios.get("api/APPProduct/GetTodayProductList").then(function(e){console.log(e),1===e.data.Code?t.items=e.data.Data:t.$alert("加载失败："+e.data.Message),t.showLoad=!1}).catch(function(e){t.showLoad=!1,t.$refs.pull.forceUpdate()})},onPullingDown:function(){var t=this;setTimeout(function(){t.initItem()},1e3)},handleSelect:function(t,e){console.log(t,e)},back:function(){this.headTitle="智慧食堂",this.showArrow=!1},changeTab:function(t,e,o){this.showArrow=!1,this.activebottom=1*t,this.$router.push("/index"+e),0===t&&(o="智慧食堂"),this.headTitle=o},changtab2:function(t){this.activebottom!==1*t&&(this.activebottom=1*t)},logout:function(){var t=this;this.loadTitle="正在退出",this.showLoad=!0,this.userToken?this.$axios({method:"post",url:"api/AppLogin/Logout?token="+this.userToken}).then(function(e){1===e.data.Code?setTimeout(function(){t.showLoad=!1,t.setUserToken(Object(v.a)()),t.$router.push("/login")},1e3):setTimeout(function(){t.showLoad=!1,t.$router.push("/login")},1e3)}).catch(function(e){t.showLoad=!1,t.$alert("请求错误",{customClass:"myConfirm"}),t.$router.push("/login")}):this.$router.push("/login")},selectFood:function(t,e){this.headTitle=e,this.showArrow=!0,this.$router.push({name:"foodDetail",params:{Id:t}})},submitForm:function(){this.dialogVisible=!0},handleClose:function(t){},submitFormRate:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return e.$refs.rateForm.resetFields(),console.log("error submit!!"),!1;e.$axios({method:"get",url:"api/APPProduct/CommentProduct?productID="+e.rateForm.productID+"&star="+e.rateForm.star+"&Content="+e.rateForm.Content+"&CanteenToken="+e.userToken}).then(function(t){1===t.data.Code?(e.$message({message:"操作成功",type:"success"}),e.dialogVisible=!1,e.activebottom=1,e.$router.push({name:"allrate",params:{refresh:0}})):(e.$message({message:t.data.Message,type:"error"}),e.dialogVisible=!1),e.$refs.rateForm.resetFields()}).catch(function(t){t.response.data.Message.match("Token")||(e.$refs.rateForm.resetFields(),e.$alert("请求出错！！",{customClass:"myConfirm"}))})})}},Object(p.b)({setUserToken:"SET_USER_TOKEN"})),components:{MyBottom:h,pull:f.default,myHead:n,Carousel:u,Loading:g.a},computed:s()({nowDay:function(){var t=new Date;return t.getFullYear()+" - "+(t.getMonth()+1)+" - "+t.getDate()},nowWeek:function(){var t=(new Date).getDay();switch(t){case 1:t="星期一";break;case 2:t="星期二";break;case 3:t="星期三";break;case 4:t="星期四";break;case 5:t="星期五";break;case 6:t="星期六";break;case 0:t="星期天"}return""+t}},Object(p.c)(["userToken"]))},_={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("transition",{attrs:{name:"slide"}},[t.show?o("div",{staticClass:"main",attrs:{id:"index"}},[t.showLoad?o("div",{ref:"loading",staticClass:"loading_out"},[o("loading",{staticClass:"loading",attrs:{title:t.loadTitle}})],1):t._e(),t._v(" "),o("my-head",{attrs:{showArrow:t.showArrow,title:t.headTitle},on:{back:t.back}},[o("div",[o("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":t.activeIndex2,mode:"horizontal","menu-trigger":"click","collapse-transition":t.collapse_transition},on:{select:t.handleSelect}},[o("el-submenu",{attrs:{index:"1"},on:{click:function(t){t.stopPropagation()}}},[o("template",{slot:"title"},[o("i",{staticClass:"el-icon-more"})]),t._v(" "),o("el-menu-item",{attrs:{index:"2-1"},on:{click:t.logout}},[t._v("\n              退出\n            ")]),t._v(" "),o("router-link",{attrs:{to:"/index"}},[o("el-menu-item",{attrs:{index:"2-2"}},[t._v("首页")])],1),t._v(" "),o("router-link",{attrs:{to:"/index/user"}},[o("el-menu-item",{attrs:{index:"2-3"}},[t._v("个人中心")])],1)],2)],1)],1)]),t._v(" "),o("div",{staticClass:"content"},[o("div",{staticClass:"bg"}),t._v(" "),o("carousel"),t._v(" "),o("div",{staticClass:"pullOut"},[o("pull",{ref:"pull",staticClass:"pull",attrs:{pullUpLoad:t.pullUpLoad,hasradius:t.hasradius,items:t.items},on:{onPullingDown:t.onPullingDown}},[o("p",[t._v(t._s(t.nowDay))]),t._v(" "),o("p",[t._v(t._s(t.nowWeek))]),t._v(" "),o("ul",t._l(t.items,function(e,a){return o("li",{key:a,on:{click:function(o){t.selectFood(e.Id,e.Name)}}},[t._v("\n              "+t._s(e.Name)+" "),e.IsRecommend?o("i",{staticClass:"iconfont recommend"},[t._v("")]):t._e(),e.IsGood?o("i",{staticClass:"iconfont recommend"},[t._v("")]):t._e()])}),0)])],1),t._v(" "),o("div",{staticClass:"sub"},[o("el-button",{class:{btn:!0},attrs:{type:"primary"},on:{click:function(e){t.submitForm()}}},[t._v("提交点评")])],1)],1),t._v(" "),o("my-bottom",{attrs:{index_active:t.activebottom},on:{changeTab:t.changeTab}}),t._v(" "),o("el-dialog",{staticStyle:{"text-align":"center"},attrs:{title:"填写评价","show-close":t.showClose,visible:t.dialogVisible,"before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[o("el-form",{ref:"rateForm",staticClass:"demo-ruleForm",attrs:{"status-icon":"",rules:t.rateRules,model:t.rateForm,"label-width":"0px"}},[o("el-form-item",{attrs:{prop:"productID"}},[o("el-select",{attrs:{placeholder:"请选择对哪道菜评价"},model:{value:t.rateForm.productID,callback:function(e){t.$set(t.rateForm,"productID",e)},expression:"rateForm.productID"}},t._l(t.items,function(t,e){return o("el-option",{key:e,attrs:{label:t.Name,value:t.Id}})}),1)],1),t._v(" "),o("el-form-item",{attrs:{prop:"Content"}},[o("el-input",{attrs:{type:"textarea",placeholder:"请填写评价",rows:"6"},model:{value:t.rateForm.Content,callback:function(e){t.$set(t.rateForm,"Content",e)},expression:"rateForm.Content"}})],1),t._v(" "),o("el-form-item",{attrs:{prop:"star",label:"对菜单评分：","label-width":"100px"}},[o("el-rate",{staticClass:"star",staticStyle:{height:"auto","padding-top":"11px"},model:{value:t.rateForm.star,callback:function(e){t.$set(t.rateForm,"star",e)},expression:"rateForm.star"}})],1)],1),t._v(" "),o("span",{staticClass:"dialog-footer text-center",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.submitFormRate("rateForm")}}},[t._v("确 定")])],1)],1),t._v(" "),o("keep-alive",[o("router-view",{on:{changtab:t.changtab2}})],1)],1):t._e()])},staticRenderFns:[]};var w=o("VU/8")(b,_,!1,function(t){o("Atbj")},"data-v-47015725",null);e.default=w.exports},Atbj:function(t,e){},J2tC:function(t,e){},YRtv:function(t,e){},"svS+":function(t,e,o){t.exports=o.p+"img/bg3.4955bac.jpg"},yiN2:function(t,e,o){t.exports=o.p+"img/bg4.4c1ad6b.jpg"}});
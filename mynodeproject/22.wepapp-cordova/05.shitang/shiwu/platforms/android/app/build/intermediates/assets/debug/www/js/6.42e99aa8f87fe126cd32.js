webpackJsonp([6],{"2jB3":function(t,s){},ia7Y:function(t,s,i){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=i("Dd8w"),e=i.n(a),o=i("NYxO"),n=i("SC/i"),l=i("NNPm"),r={data:function(){return{show:!1,items:[],showLoad:!1,loadTitle:"正在注销",dialogVisible:!1,appendToBody:!0,imageUrl:""}},created:function(){var t=this;this.$emit("changtab","3"),this.init(),setTimeout(function(){t.show=!0},20)},methods:e()({init:function(){var t=this;this.$axios.get("api/AppUser/GetUserInfo?CanteenToken="+this.userToken).then(function(s){console.log(s),1===s.data.Code&&(t.items=s.data.Data)})},signout:function(){var t=this;this.showLoad=!0,this.userToken?this.$axios({method:"post",url:"api/AppLogin/Logout?token="+this.userToken}).then(function(s){1===s.data.Code?setTimeout(function(){t.showLoad=!1,t.setUserToken(Object(l.a)()),t.$router.push("/login")},1e3):setTimeout(function(){t.showLoad=!1,console.log(s.data.Message),t.$router.push("/login")},1e3)}).catch(function(s){t.showLoad=!1,t.$alert("请求错误",{customClass:"myConfirm"}),t.$router.push("/login")}):this.$router.push("/login")},updateImg:function(){this.dialogVisible=!0},handleChange:function(t,s){this.files=t.raw,this.imageUrl=URL.createObjectURL(t.raw)},submitImgForm:function(){var t=this,s=new FormData;s.append("file",this.files),this.$axios.post("api/AppUser/UpdateUserHeadImg?CanteenToken="+this.userToken+"&isformdata=0",s,{headers:{"Content-Type":"multipart/form-data"}}).then(function(s){console.log(s),1===s.data.Code&&(t.dialogVisible=!1,t.$message({message:"上传成功",type:"success"}),t.init())}).catch(function(s){s.response.data.Message.match("Token")?(t.$message({message:"登录过期，请重新登录，即将跳转到登录页面！！",duration:2200}),setTimeout(function(){t.$router.push("/login")},2e3)):t.$alert("请求出错！！",{customClass:"myConfirm"})})}},Object(o.b)({setUserToken:"SET_USER_TOKEN"})),computed:e()({},Object(o.c)(["userToken"])),components:{Loading:n.a}},c={render:function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("transition",{attrs:{name:"leftIn"}},[t.show?a("div",{staticClass:"user"},[t.showLoad?a("div",{ref:"loading",staticClass:"loading_out"},[a("loading",{staticClass:"loading",attrs:{title:t.loadTitle}})],1):t._e(),t._v(" "),a("div",{staticClass:"top"},[a("div",{staticClass:"topbg"}),t._v(" "),a("div",{staticClass:"card"},[a("div",{staticClass:"inner"},[a("div",[a("img",{attrs:{src:t.items.HeadImg?"http://chenxiaoming.canteen.sundar.top:8060/"+t.items.HeadImg:i("FWfe"),alt:""},on:{click:t.updateImg}}),t._v(" "),a("p",[t._v(t._s(t.items.Account))])])])])]),t._v(" "),a("div",{staticClass:"content"},[a("ul",[a("li",[a("div",{staticClass:"left"},[a("div",{staticClass:"fl"},[t._v("\n              我的消息\n            ")])]),t._v(" "),a("div",{staticClass:"right"},[a("i",{staticClass:"el-icon-arrow-right"})])]),t._v(" "),a("li",[a("div",{staticClass:"left"},[a("div",{staticClass:"fl"},[t._v("\n              我的建议\n            ")])]),t._v(" "),a("div",{staticClass:"right"},[a("i",{staticClass:"el-icon-arrow-right"})])]),t._v(" "),a("router-link",{attrs:{to:"/index/myrate"}},[a("li",[a("div",{staticClass:"left"},[a("div",{staticClass:"fl"},[t._v("\n              我的点评\n            ")])]),t._v(" "),a("div",{staticClass:"right"},[a("i",{staticClass:"el-icon-arrow-right"})])])]),t._v(" "),a("li",[a("div",{staticClass:"left"},[a("div",{staticClass:"fl"},[t._v("\n              联系方式\n            ")])]),t._v(" "),a("div",{staticClass:"right"},[a("span",[t._v(t._s(t.items.Mobile))])])])],1),t._v(" "),a("div",{staticClass:"sub"},[a("el-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:function(s){t.signout()}}},[t._v("注销")])],1)]),t._v(" "),a("el-dialog",{staticStyle:{"text-align":"center"},attrs:{title:"上传头像","append-to-body":t.appendToBody,visible:t.dialogVisible},on:{"update:visible":function(s){t.dialogVisible=s}}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","auto-upload":!1,"show-file-list":!1,"on-change":t.handleChange}},[t.imageUrl?a("img",{staticClass:"avatar",attrs:{src:t.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),t._v(" "),a("span",{staticClass:"dialog-footer text-center",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(s){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(s){t.submitImgForm()}}},[t._v("确 定")])],1)],1)],1):t._e()])},staticRenderFns:[]};var d=i("VU/8")(r,c,!1,function(t){i("2jB3")},"data-v-267e4130",null);s.default=d.exports}});